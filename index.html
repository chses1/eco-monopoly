<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>ç’°ä¿å°å°–å…µå¤§å¯Œç¿</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background-image: url('https://www.chses.tyc.edu.tw/UpFile/Cairo1680/backgroung.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      color: #000;
      font-size: 1.2rem;
    }
    .container {
      width: 100%;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: 0 20px;
      gap: 30px;
      box-sizing: border-box;
    }
    .board {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      grid-auto-rows: 120px;
      grid-gap: 4px;
      position: relative;
      width: 1200px;
      margin: 0 auto;
    }
    .cell {
      min-height: 100px;
      height: auto;
      border: 1px solid #000;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-size: 1.2rem;
      text-align: center;
      background-color: #f0f0f0;
      position: relative;
      padding: 12px 16px;
      box-sizing: border-box;
      word-break: break-word;
    }
    .cell-text {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 4px;
      text-align: center;
      line-height: 1.4;
      font-size: clamp(0.9rem, 1.1vw, 1.2rem);
      overflow: visible;
    }
    .cell img {
      width: 48px;
      height: 48px;
      margin-bottom: 4px;
    }
  .highlight {
  background-color: #ffeb3b;
  animation: pulse 0.8s ease-in-out 2;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.08); }
  100% { transform: scale(1); }
}
.victory-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  animation: fadeIn 1s ease-in-out;
}
.victory-banner {
  background: #fff;
  padding: 40px;
  border-radius: 20px;
  box-shadow: 0 0 20px rgba(0,0,0,0.5);
  text-align: center;
  animation: popIn 0.6s ease;
}
.victory-banner h2 {
  font-size: 2.5rem;
  margin-bottom: 20px;
  color: #d32f2f;
}
.victory-banner button {
  font-size: 1.5rem;
  padding: 10px 30px;
  margin-top: 10px;
  background: #4caf50;
  color: white;
  border: none;
  border-radius: 10px;
  cursor: pointer;
}
@keyframes popIn {
  0% { transform: scale(0.5); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
</style>
</head>
<body>
  <h1 style="font-size: 4rem; color: #ffeb3b; text-shadow: 3px 3px 6px #000; font-weight: bold; margin-bottom: 20px;">ğŸŒ ç’°ä¿å°å°–å…µå¤§å¯Œç¿ ğŸŒ¿</h1>
  <div class="container">
    <div style="flex: 0 0 240px; display: flex; flex-direction: column; align-items: flex-start; gap: 20px; font-size: 1.4rem; margin-top: 20px;">
      <button id="roll-btn" onclick="rollDice()" style="display: flex; align-items: center; justify-content: center; width: 100%; aspect-ratio: 3 / 1; font-size: 2.4rem; padding: 0; border-radius: 20px; background: #ffeb3b; border: 3px solid #333; white-space: nowrap;">ğŸ² æ“²éª°å­</button>
      <p id="status" style="font-size: 1.6rem; font-weight: bold; min-height: 2.2rem; white-space: nowrap; color: red;"></p>
      <div id="question-box" style="display:none; max-width: 90vw; padding: 10px; background-color: rgba(255, 255, 255, 0.9); border-radius: 10px; font-size: 1.4rem;">
        <p id="question"></p>
        <div class="decision-buttons">
          <button onclick="judgeAnswer(true)" style="font-size: 1.5rem;">â­• ç­”å°</button>
          <button onclick="judgeAnswer(false)" style="font-size: 1.5rem;">âŒ ç­”éŒ¯</button>
        </div>
      </div>
      <div id="action-icon" style="font-size: 2rem; color: red; font-weight: bold;"></div>
    </div>
    <div class="board" id="board"></div>
    <div style="flex: 0 0 240px; display: flex; flex-direction: column; align-items: flex-start; gap: 20px; font-size: 1.4rem; margin-top: 20px; background-color: rgba(255,255,255,0.85); padding: 20px; border-radius: 10px;">
      <div style="font-size: 1.6rem; font-weight: bold; margin-bottom: 10px;">ğŸ¯ åˆ†æ•¸çµ±è¨ˆ</div>
      <div style="background: #e0f7fa; padding: 10px 20px; border-radius: 8px; width: calc(100% - 10px); text-align: left; box-sizing: border-box;"><img src="https://www.chses.tyc.edu.tw/UpFile/Cairo1680/player1.png" alt="è—éµ²" style="width:32px; vertical-align:middle; margin-right:6px;">è—éµ²ï¼š <span id="score-blue">0</span> åˆ†</div>
      <div style="background: #e8eaf6; padding: 10px 20px; border-radius: 8px; width: calc(100% - 10px); text-align: left; box-sizing: border-box;"><img src="https://www.chses.tyc.edu.tw/UpFile/Cairo1680/player2.png" alt="ç¶ ç¹¡çœ¼" style="width:32px; vertical-align:middle; margin-right:6px;">ç¶ ç¹¡çœ¼ï¼š <span id="score-green">0</span> åˆ†</div>
      <div style="margin-top: 20px; font-size: 1.2rem; line-height: 1.6;">
        ğŸ“œ <strong>éŠæˆ²è¦å‰‡ï¼š</strong><br>é›™æ–¹è¼ªæµæ“²éª°å‰é€²ï¼Œç¬¬ä¸€ä½ç²å¾— 3 åˆ†çš„éšŠä¼å³ç²å‹ï¼
      </div>
    </div>
  </div>
  <script>
    const layout = [
  "èµ·é»",
  "ä½ åƒåŠ éè·³èš¤å¸‚å ´å—èªªå‡º",
  "èªªå‡ºä¸€ç¨®å°ç£ç‰¹æœ‰ç¨®å‹•ç‰©",
  "äº‚ç æ¨¹æœ¨æœƒç™¼ç”Ÿä»€éº¼äº‹",
  "å›åˆ°èµ·é»",
  "èªªå‡ºä¸€å€‹æš–åŒ–å°åœ°çƒçš„å‚·å®³", 
  "èªªå‡ºç©ºæ°£æ±™æŸ“å°äººé«”çš„å‚·å®³",    
  "ä½ æ‹¿ä»€éº¼è£½ä½œç’°ä¿æ¸…æ½”åŠ‘",    
  "å‰é€²å…©æ­¥",
  "æ€éº¼ä¿è­·å‹•ç‰©",    
  "èªªå‡ºå¡‘è† å°æµ·æ´‹ç”Ÿç‰©çš„å‚·å®³",    
  "ç”¨éçš„ç´™ç›’é‚„å¯ä»¥åšä»€éº¼",    
  "å‰é€²ä¸‰æ­¥",  
  "æ´—ç±³æ°´é‚„å¯ä»¥æ‹¿ä¾†åšä»€éº¼",  
  "èˆ‰å‡ºä¸€ç¨®æ¸›å¡‘çš„æ–¹æ³•", 
  "èªªå‡ºä¸€ç¨®ä½æ±¡æŸ“çš„äº¤é€šå·¥å…·",
  "å¾Œé€€å…©æ­¥",   
  "ç¯€é›»è¡Œå‹•ï¼šé—œé–‰ä¸€ç›é›»é¢¨æ‰‡",   
  "å¹å†·æ°£æœƒé€ æˆåœ°çƒæš–åŒ–å—",   
   "èµ°è·¯ä¸Šå­¸å¯ä»¥æ¸›å°‘ç©ºæ±™å—",   
  "æˆ‘å€‘æ€éº¼æ„›è­·å±±æ—",  
  "å°ç£æ¸›å¡‘æœ‰ä»€éº¼è¦å®š",   
  "å¾Œé€€å…©æ­¥",
  "å†°å±±èåŒ–æœƒå‚·å®³ä»€éº¼å‹•ç‰©",
  "æ€éº¼æ„›æƒœé£Ÿç‰©",
  "æš«åœä¸€æ¬¡", 
  "èªªå‡ºä¸€ç¨®ç€•è‡¨çµ•ç¨®çš„å‹•ç‰©",
  "ç¯€æ°´è¡Œå‹•ï¼šæª¢æŸ¥èµ°å»Šæ°´é¾é ­", 
  "æ±¡æ°´è™•ç†å» åœ¨åšä»€éº¼",  
  "æˆ‘æ„›åœ°çƒèªªä¸‰æ¬¡"
];

    const specialMove = {
      "å‰é€²å…©æ­¥": 2,
      "å‰é€²ä¸‰æ­¥": 3,
      "å¾Œé€€å…©æ­¥": -2,
      "å›åˆ°èµ·é»": "start"
    };

    const boardSize = layout.length;
    let positions = [0, 0];
    let scores = [0, 0];
    let currentPlayer = 0;
    let skipTurn = [false, false];
    const boardEl = document.getElementById('board');
    const playerImages = [
  'https://www.chses.tyc.edu.tw/UpFile/Cairo1680/player2.png', // ç¶ ç¹¡çœ¼
  'https://www.chses.tyc.edu.tw/UpFile/Cairo1680/player1.png'  // è—éµ²
];

    for (let row = 0; row < 5; row++) {
      for (let col = 0; col < 6; col++) {
        let index = row * 6 + (row % 2 === 0 ? col : 5 - col);
        if (index >= layout.length) continue;
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.id = `cell-${index}`;
        let arrow = 'â¡ï¸';
        if (col === 5 && row % 2 === 0 && row < 4) arrow = 'â¬‡ï¸';
        else if (col === 0 && row % 2 === 1 && row < 4) arrow = 'â¬‡ï¸';
        else if (row % 2 === 1) arrow = 'â¬…ï¸';
        cell.innerHTML = `<div class='cell-text'>${layout[index]}</div><div class='arrow'>${arrow}</div>`;
        boardEl.appendChild(cell);
      }
    }

    function updateBoard() {
      layout.forEach((_, i) => {
        const cell = document.getElementById(`cell-${i}`);
        if (cell) {
          const row = Math.floor(i / 6);
        const col = row % 2 === 0 ? i % 6 : 5 - (i % 6);
        let arrow = 'â¡ï¸';
        if (col === 5 && row % 2 === 0 && row < 4) arrow = 'â¬‡ï¸';
        else if (col === 0 && row % 2 === 1 && row < 4) arrow = 'â¬‡ï¸';
        else if (row % 2 === 1) arrow = 'â¬…ï¸';
        cell.innerHTML = `<div class='cell-text'>${layout[i]}</div><div class='arrow'>${arrow}</div>`;
          cell.querySelectorAll('img').forEach(img => img.remove());
        }
      });
      positions.forEach((pos, idx) => {
        const target = document.getElementById(`cell-${pos}`);
        if (target) {
          let container = target.querySelector('.player-container');
          if (!container) {
            container = document.createElement('div');
            container.className = 'player-container';
            container.style.display = 'flex';
            container.style.gap = '4px';
            container.style.justifyContent = 'center';
            container.style.alignItems = 'center';
            target.prepend(container);
          }
          const img = document.createElement('img');
          img.src = playerImages[idx];
          img.alt = `player${idx + 1}`;
          if (positions[idx] > 0) {
  const direction = idx === 0
    ? (positions[idx] % 12 < 6 ? 'right' : 'left')
    : (positions[idx] % 12 < 6 ? 'right' : 'left');
  img.style.transform = direction === 'left' ? 'scaleX(-1)' : 'scaleX(1)';
}
          container.appendChild(img);
        }
      });
      document.getElementById('score-green').textContent = scores[0];
      document.getElementById('score-blue').textContent = scores[1];
    }

    function rollDice() {
      const rollBtn = document.getElementById('roll-btn');
      if (!rollBtn) return;
      rollBtn.disabled = true;
      document.getElementById('action-icon').innerHTML = '';
      
if (skipTurn[currentPlayer]) {
  skipTurn[currentPlayer] = false;
  document.getElementById('action-icon').innerHTML = 'â¸ï¸ æš«åœä¸€å›åˆï¼';
  currentPlayer = 1 - currentPlayer;
  rollBtn.disabled = false;
  return;
currentPlayer = 1 - currentPlayer;
        rollBtn.disabled = false;
        return;
      }
      const roll = Math.floor(Math.random() * 6) + 1;
      const status = document.getElementById('status');
      status.innerHTML = `<img src="${playerImages[currentPlayer]}" style="width: 28px; vertical-align: middle; margin-right: 6px;">${currentPlayer === 0 ? 'ç¶ ç¹¡çœ¼' : 'è—éµ²'} æ“²å‡º ${roll} é»`;
      status.style.color = currentPlayer === 0 ? 'limegreen' : 'deepskyblue';
      let newPos = positions[currentPlayer] + roll;
      if (newPos >= boardSize - 1) {
        const playerName = currentPlayer === 0 ? 'ç¶ ç¹¡çœ¼' : 'è—éµ²';
        
scores[currentPlayer]++;
if (scores[currentPlayer] >= 3) {
  const overlay = document.createElement('div');
  overlay.className = 'victory-overlay';
  overlay.innerHTML = `
    <div class='victory-banner'>
      <h2>ğŸ‰ ${playerName} ç²å‹ï¼</h2>
      <button onclick='restartGame()'>é‡æ–°é–‹å§‹</button>
    </div>`;
  document.body.appendChild(overlay);
  positions = [0, 0];
  scores = [0, 0];
} else {
  showScorePopup(playerName);
}

        if (scores[currentPlayer] >= 3) {
          const overlay = document.createElement('div');
overlay.className = 'victory-overlay';
overlay.innerHTML = `
  <div class='victory-banner'>
    <h2>ğŸ‰ ${currentPlayer === 0 ? 'ç¶ ç¹¡çœ¼' : 'è—éµ²'} ç²å‹ï¼</h2>
    <button onclick='restartGame()'>é‡æ–°é–‹å§‹</button>
  </div>`;
document.body.appendChild(overlay);
          positions = [0, 0];
          scores = [0, 0];
        } else {
          positions[currentPlayer] = 0;
        }
        updateBoard();
        rollBtn.disabled = false;
        return;
      }
      positions[currentPlayer] = newPos;
      updateBoard();
      const currentEvent = layout[newPos];
      const currentCell = document.getElementById(`cell-${newPos}`);
      if (specialMove.hasOwnProperty(currentEvent) || currentEvent === 'æš«åœä¸€æ¬¡') {
        currentCell.classList.add('highlight');
        playSound();
        setTimeout(() => currentCell.classList.remove('highlight'), 1200);
      }

      
if (specialMove.hasOwnProperty(currentEvent)) {
  const steps = specialMove[currentEvent];
  if (steps === "start") {
    playSound(false);  // å›åˆ°èµ·é»éŸ³æ•ˆ
    positions[currentPlayer] = 0;
  } else {
    if (steps > 0) playSound(true);
    else playSound(false);
    positions[currentPlayer] += steps;
    if (positions[currentPlayer] < 0) positions[currentPlayer] = 0;
  }
  updateBoard();
  currentPlayer = 1 - currentPlayer;
  rollBtn.disabled = false;
  return;

        let msg = '', icon = '';
        if (specialMove[currentEvent] === "start") {
          msg = 'å›åˆ°èµ·é»ï¼'; icon = 'ğŸ”';
          positions[currentPlayer] = 0;
        } else {
          const steps = specialMove[currentEvent];
          if (steps > 0) {
            msg = `å‰é€² ${steps} æ­¥ï¼`; icon = 'â¡ï¸';
          } else {
            msg = `å¾Œé€€ ${-steps} æ­¥ï¼`; icon = 'â¬…ï¸';
          }
          positions[currentPlayer] += steps;
          if (positions[currentPlayer] < 0) positions[currentPlayer] = 0;
        }
        document.getElementById('action-icon').innerHTML = `${icon} ${msg}`;
        updateBoard();
        currentPlayer = 1 - currentPlayer;
        rollBtn.disabled = false;
        return;
      }

      
if (currentEvent === "æš«åœä¸€æ¬¡") {
  playSound(false);

        skipTurn[currentPlayer] = true;
        document.getElementById('action-icon').innerHTML = 'â¸ï¸ æš«åœä¸€å›åˆï¼';
        updateBoard();
        currentPlayer = 1 - currentPlayer;
        rollBtn.disabled = false;
        return;
      }

      document.getElementById('question').textContent = currentEvent;
      document.getElementById('question-box').style.display = 'block';
      document.getElementById('question-box').dataset.prev = newPos - roll;
    }

    
function judgeAnswer(correct) {
  playSound(correct);
  document.getElementById("roll-btn").disabled = false;
  if (!correct) {
    const prev = parseInt(document.getElementById('question-box').dataset.prev);
    positions[currentPlayer] = isNaN(prev) ? positions[currentPlayer] : prev;
    updateBoard();
  }
  document.getElementById("question-box").style.display = "none";
      currentPlayer = 1 - currentPlayer;
    }

    updateBoard();
  function restartGame() {
  positions = [0, 0];
  scores = [0, 0];
  skipTurn = [false, false];
  currentPlayer = 0;
  document.getElementById('status').textContent = '';
  document.getElementById('action-icon').textContent = '';
  document.getElementById('question-box').style.display = 'none';
  const overlay = document.querySelector('.victory-overlay');
  if (overlay) overlay.remove();
  updateBoard();
  document.getElementById('roll-btn').disabled = false;
  playSound(correct);
}
</script>

<script>
  
function playSound(correct) {
  const correctAudio = document.getElementById("audio-correct");
  const wrongAudio = document.getElementById("audio-wrong");
  [correctAudio, wrongAudio].forEach(audio => {
    audio.pause();
    audio.currentTime = 0;
  });
  (correct ? correctAudio : wrongAudio).play();
}
</script>

<audio id="audio-correct" src="correct.mp3" preload="auto"></audio>
<audio id="audio-wrong" src="wrong.mp3" preload="auto"></audio>
<script>
function playSound(correct) {
  const correctAudio = document.getElementById("audio-correct");
  const wrongAudio = document.getElementById("audio-wrong");
  [correctAudio, wrongAudio].forEach(audio => {
    audio.pause();
    audio.currentTime = 0;
  });
  (correct ? correctAudio : wrongAudio).play();
}
</script>

<!-- å¾—åˆ†å‹•ç•«å€ -->
<div id="score-popup" class="popup" style="display: none;">
  <div class="popup-content" id="score-message">ğŸ ç²å¾— 1 åˆ†ï¼Œ5 ç§’å¾Œç¹¼çºŒéŠæˆ²</div>
</div>
<style>
.popup {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}
.popup-content {
  background: white;
  padding: 2rem 3rem;
  font-size: 2rem;
  border-radius: 16px;
  animation: popIn 0.5s ease;
  box-shadow: 0 0 15px rgba(0,0,0,0.3);
}
@keyframes popIn {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}
</style>

<script>
function showScorePopup(playerName) {
  const popup = document.getElementById("score-popup");
  const message = document.getElementById("score-message");
  message.innerText = `ğŸ ${playerName} ç²å¾— 1 åˆ†ï¼Œ5 ç§’å¾Œç¹¼çºŒéŠæˆ²`;
  popup.style.display = "flex";
  setTimeout(() => {
    popup.style.display = "none";
  }, 5000);
}
function showVictory(playerName) {
  const popup = document.getElementById("score-popup");
  const message = document.getElementById("score-message");
  message.innerText = `ğŸ† ${playerName} ç²å‹å•¦ï¼`;
  popup.style.display = "flex";
}
</script>
</body>


</html>
